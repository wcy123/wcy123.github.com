# 2020-04-04 start to use mdbook to write my blog

## download and install mdbook

[mdbook@github](https://github.com/rust-lang/mdBook)

```bash
cargo install mdbook
```

### create a book

```bash
mkdir ~/d/working/wcy123.github.com/
mdbook init
```

I modifiy `book.toml` as following, copy some configurations from [mdBook/book-example/book.toml](https://github.com/rust-lang/mdBook/blob/master/book-example/book.toml)


```toml
{{#include ../book.toml}}
```

We can include another file by using a preprocessor, the above is generated by

````hbs
```toml
\{{#include ../book.toml}}
```
````

refer to [mdBook-specific markdown](https://github.com/rust-lang/mdBook/blob/master/book-example/src/format/mdbook.md) for detail

### start the server

```bash
mdbook serve
open http://localhost:3000
```

### MathJax support


block equations

\\[
(a+b)^2 = a^2 + 2ab + b^2
\\]

where \\( (a+b)^2 = a^2 + 2ab + b^2 \\) is an inline equations

refer to [MathJax Support](https://rust-lang.github.io/mdBook/format/mathjax.html) for detail

### source code syntax high light


```c
#include <stdio.h>
int main(int argc, char* argv[]) {
    printf("hello world\n");
}
```

```rust
fn foo() -> i32 {
    1 + 1
}
```

### CI integration and deploy automation

- create a github token

  refer to [creating a token]. for detail.

- enable travis ci

    refer to https://travis-ci.org/github/

    activate Travis CI and set environment variable GITHUB_TOKEN to your token.

    read [secure your token][secure your data]

- deploy automation

read [Running mdbook in Continuous Integration] and [GitHub Pages Deployment][github pages deployment]

edit `<PROJECT_ROOT>/.travis.yml`

```yaml
{{#include ../.travis.yml}}
```

[secure your data]: https://docs.travis-ci.com/user/best-practices-security#recommendations-on-how-to-avoid-leaking-secrets-to-build-logs

[creating a token]: https://help.github.com/en/github/authenticating-to-github/creating-a-personal-access-token-for-the-command-line#creating-a-token

[Running mdbook in Continuous Integration]: https://github.com/rust-lang/mdBook/blob/master/book-example/src/continuous-integration.md

[GitHub Pages Deployment]: https://docs.travis-ci.com/user/deployment/pages/

NOTE: we must set the `local-dir` to `book` which is the output directory of `mdbook`


## theme

```bash
# get the default theme
mkdir -p $HOME/tmp/book
cd $HOME/tmp/book
mdbook init --theme
cd - # go back to your book directory
cp -av $HOME/tmp/book/src/theme ./ # copy default theme
curl -sLo src/theme/highlight.css  cdnjs.cloudflare.com/ajax/libs/highlight.js/9.18.1/styles/solarized-light.min.css
```

NOTE: it is confusing whether the theme directory is `./theme` or `./src/theme`, it seems `./theme` is preferred.
