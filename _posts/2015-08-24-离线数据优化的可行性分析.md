---
layout: post
title:  "离线数据优化的可行性分析"
date:   2015/08/24 15:18:03
categories:
comments: true
draft: true
---


 - $$ \rho = 97\% $$ 无离线数据的概率，大多数用户无离线数据。
 - $$ R_e $$ 每次无离线数据(empty)时，lrange 的操作时间。
 - $$ R_x $$ 每次有离线数据的时候， lrange 的操作时间。
 - $$ R_l $$ 每次 llen 的操作时间

原来的方法的平均操作时间是，即直接使用 lrange

$$
T_0 = \rho R_e + ( 1 - \rho ) R_x
$$

改进方法的平均操作时间时，即先用 llen 判断，如果有数据再使用 lrange

$$
T_1 = 100\%  R_l + ( 1 - \rho ) R_x
$$

我们期待

$$
T_1 \leq T_0
$$

简单化简

$$
\frac{R_l}{R_e} \leq \rho
$$

也就是说，llen 的操作时间喝 lrange 再无用户数据的情况下的操作时间的比
值小于无离线消息的概率。
